#!/usr/bin/env ruby
# frozen_string_literal: true

require "bundler/setup"
require "grumlin"
require "irb"

Grumlin.configure do |config|
  config.url = ENV["GREMLIN_URL"] || "ws://localhost:8182/gremlin"
end

Async do
  g = Grumlin::Traversal.new

  IRB.setup(nil)
  workspace = IRB::WorkSpace.new(binding)
  irb = IRB::Irb.new(workspace)
  irb.eval_input
rescue StandardError
  raise
ensure
  Grumlin.config.default_client&.disconnect
end
